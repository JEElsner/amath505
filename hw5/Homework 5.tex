\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Keep aspect ratio if custom image width or height is specified
    \setkeys{Gin}{keepaspectratio}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro

    \usepackage{iftex}
    \ifPDFTeX
        \usepackage[T1]{fontenc}
        \IfFileExists{alphabeta.sty}{
              \usepackage{alphabeta}
          }{
              \usepackage[mathletters]{ucs}
              \usepackage[utf8x]{inputenc}
          }
    \else
        \usepackage{fontspec}
        \usepackage{unicode-math}
    \fi

    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{array}     % table support for pandoc >= 2.11.3
    \usepackage{calc}      % table minipage width calculation for pandoc >= 2.11.1
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{soul}      % strikethrough (\st) support for pandoc >= 3.0.0
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}

    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}


    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{Homework 5}
    
    
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.61,0.40,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.80,0.25,0.22}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.46,0.46,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.41,0.47,0.13}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.36,0.12}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.52,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{0.89,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@ges}{\let\PY@bf=\textbf\let\PY@it=\textit}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb.
    \makeatletter
        \newbox\Wrappedcontinuationbox
        \newbox\Wrappedvisiblespacebox
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}}
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}}
        \newcommand*\Wrappedcontinuationindent {3ex }
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox}
        % Take advantage of the already applied Pygments mark-up to insert
        % potential linebreaks for TeX processing.
        %        {, <, #, %, $, ' and ": go to next line.
        %        _, }, ^, &, >, - and ~: stay at end of broken line.
        % Use of \textquotesingle for straight quote.
        \newcommand*\Wrappedbreaksatspecials {%
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}%
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}%
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}%
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}%
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}%
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}%
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}%
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}%
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}%
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}%
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}%
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}%
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}%
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}%
        }
        % Some characters . , ; ? ! / are not pygmentized.
        % This macro makes them "active" and they will insert potential linebreaks
        \newcommand*\Wrappedbreaksatpunct {%
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}%
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}%
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}%
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}%
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}%
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}%
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}%
            \catcode`\.\active
            \catcode`\,\active
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active
            \lccode`\~`\~
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%

        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}

    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \section{Part 1: Rankine Vortex}\label{part-1-rankine-vortex}

\subsection{\texorpdfstring{Vortex Velocity as a Function of
\(r\)}{Vortex Velocity as a Function of r}}\label{vortex-velocity-as-a-function-of-r}

The vertical component of vorticity in polar coordinates is:

\[ \omega_z = \frac{1}{r} \frac{\partial}{\partial r} \left(r u_\theta \right) - \frac{1}{r} \frac{\partial u_r}{\partial \theta}\]

Taking \(\frac{\partial u_r}{\partial \theta} = 0\) since the vortex is
axissymmetric, we get:

\[ \omega_z = \frac{\partial}{\partial r} \left(r u_\theta \right) \]

For \$ r \leq R \$, \(\omega_z(r) = \omega_0\), and we can derive:

\[ \begin{split}
\int_0^r r \omega_0 dr &= \int_0^r \frac{\partial}{\partial r} \left(r u_\theta \right) dr \\
\frac{1}{2}r^2 \omega_z &= r u_\theta \\
u_\theta &= \frac{r \omega_0}{2}
\end{split}\]

For \$ r \leq R \$, we assume \(\omega_z(r) = 0\), and in that
case have:

\$\$

\begin{split}

\int  dr &= \int \frac{\partial}{\partial r} \left(r u_\theta \right) dr \\
C &= r u_\theta \\
u_\theta &= \frac{C}{r}

\end{split}

\$\$

Note that this is equivalent to saying \$ r u\_\theta \$ is constant
with respect to r, which makes sense, because that is angular velocity,
which we expect to be constant.

Combining these two cases, we get:

\[ u_\theta(r) = \begin{cases}
\frac{1}{2}r \omega_0 & r \leq R \\
\frac{C}{r} & r > R
\end{cases}
\]

\subsection{Material Volume Sketch}\label{material-volume-sketch}

The sketch below shows the evolution of two material volumes, one inside
the vortex core and one outside from time \$ t = t\_1 \$ to \$ t = t\_2
\$ with \$ t\_2 > t\_1 \$ and the circulation of the
vortex, \$ \Gamma > 0 \$. We observe that the volume in the
core both rotates and revolves around the vortex axis, while the volume
outside the core purely revolves around the vortex center, with no
rotation.

\subsection{Infinitesimally Small Vortex
Core}\label{infinitesimally-small-vortex-core}

If we shrink the vortex core to be infinitesimally small, then the
velocity function becomes that of an idealized point vortex, except at
the vortex core, where the Rankine Vortex velocity is 0, while the point
vortex velocity blows up to infinity.

    \section{Part 2}\label{part-2}

Note: key code in the \texttt{hw5} module for \texttt{VortexManager} and
\texttt{animate} is attached at the end of this assignment.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}

\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{from} \PY{n+nn}{matplotlib} \PY{k+kn}{import} \PY{n}{colors}

\PY{k+kn}{from} \PY{n+nn}{hw5} \PY{k+kn}{import} \PY{n}{VortexManager}\PY{p}{,} \PY{n}{animate}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{ipympl}
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} widget
\end{Verbatim}
\end{tcolorbox}

    \subsection{Dipole}\label{dipole}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{dt} \PY{o}{=} \PY{l+m+mf}{0.1}

\PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{)}
\PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    When the vortices have the same circulation, they revolve around each
other, thus revolving around their centerpoint.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{dipole} \PY{o}{=} \PY{n}{VortexManager}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{v1} \PY{o}{=} \PY{n}{dipole}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{v2} \PY{o}{=} \PY{n}{dipole}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} anim = animate(dipole,  x, y, dt, figsize=(9, 3), duration=250)}
\PY{c+c1}{\PYZsh{} anim.save(\PYZsq{}./dipole\PYZus{}advection.gif\PYZsq{})}

\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
\PY{n}{points} \PY{o}{=} \PY{n}{dipole}\PY{o}{.}\PY{n}{step\PYZus{}forward}\PY{p}{(}\PY{n}{dt}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{points}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{k}{for} \PY{n}{point} \PY{o+ow}{in} \PY{n}{points}\PY{p}{:}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{o}{*}\PY{n}{point}\PY{p}{)}

\PY{c+c1}{\PYZsh{} plt.tight\PYZus{}layout()}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Matched Dipoles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
(2, 2, 101)
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Homework 5_files/Homework 5_7_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Below we see the paths of two counterrotating vortices advecting each
other in a straight line.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{dipole\PYZus{}adv} \PY{o}{=} \PY{n}{VortexManager}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{v1} \PY{o}{=} \PY{n}{dipole\PYZus{}adv}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{v2} \PY{o}{=} \PY{n}{dipole\PYZus{}adv}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} anim = animate(dipole,  x, y, dt, figsize=(9, 3), duration=250)}
\PY{c+c1}{\PYZsh{} anim.save(\PYZsq{}./dipole\PYZus{}advection.gif\PYZsq{})}

\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
\PY{n}{points} \PY{o}{=} \PY{n}{dipole\PYZus{}adv}\PY{o}{.}\PY{n}{step\PYZus{}forward}\PY{p}{(}\PY{n}{dt}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{points}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{k}{for} \PY{n}{point} \PY{o+ow}{in} \PY{n}{points}\PY{p}{:}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{o}{*}\PY{n}{point}\PY{p}{)}

\PY{c+c1}{\PYZsh{} plt.tight\PYZus{}layout()}
\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Counterrotating Dipole Advection}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
(2, 2, 1001)
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Homework 5_files/Homework 5_9_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    If one of the vortices has a greater circulation, we see that the other
begins to revolve around it, and they both take a elliptical path.
Instead of revolving around their average position like we saw in the
first dipole with same-sign circulation, in this case they revolve
around a point elsewhere (methinks it is the average of their positions
weighted by their circulations).

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{unbalanced} \PY{o}{=} \PY{n}{VortexManager}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{v1} \PY{o}{=} \PY{n}{unbalanced}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{v2} \PY{o}{=} \PY{n}{unbalanced}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}

\PY{c+c1}{\PYZsh{} anim = animate(unbalanced,  x, y, dt, figsize=(9, 3), duration=250)}
\PY{c+c1}{\PYZsh{} anim.save(\PYZsq{}./dipole\PYZus{}advection.gif\PYZsq{})}

\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
\PY{n}{points} \PY{o}{=} \PY{n}{unbalanced}\PY{o}{.}\PY{n}{step\PYZus{}forward}\PY{p}{(}\PY{n}{dt}\PY{p}{,} \PY{l+m+mi}{200}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{points}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{k}{for} \PY{n}{point} \PY{o+ow}{in} \PY{n}{points}\PY{p}{:}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{o}{*}\PY{n}{point}\PY{p}{)}

\PY{c+c1}{\PYZsh{} plt.tight\PYZus{}layout()}
\PY{c+c1}{\PYZsh{} ax.set\PYZus{}ylim((0,3))}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dipole Advection}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
(2, 2, 201)
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Homework 5_files/Homework 5_11_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Corner Boundaries}\label{corner-boundaries}

    Here we see the velocity field created by a vortex at point \((9, 1)\),
equidistant from both walls forming a corner at \((10, 10)\). Velocity
is essentially parallel to the walls, especially so along the lines
connecting the point to the walls perpendicularly.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{21}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{corner\PYZus{}vel} \PY{o}{=} \PY{n}{VortexManager}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{boundaries}\PY{o}{=}\PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bottom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}
\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{v1} \PY{o}{=} \PY{n}{corner\PYZus{}vel}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{9}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}

\PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mf}{8.9}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}
\PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{1.1}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}

\PY{n}{xs}\PY{p}{,} \PY{n}{ys} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{meshgrid}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}

\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}

\PY{n}{vels} \PY{o}{=} \PY{n}{corner\PYZus{}vel}\PY{o}{.}\PY{n}{velocity\PYZus{}at}\PY{p}{(}\PY{n}{xs}\PY{p}{,} \PY{n}{ys}\PY{p}{,} \PY{n}{mirror\PYZus{}vortices}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{norm} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{vels}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{cs} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{quiver}\PY{p}{(}\PY{n}{xs}\PY{p}{,} \PY{n}{ys}\PY{p}{,} \PY{o}{*}\PY{n}{vels}\PY{o}{/}\PY{n}{norm}\PY{p}{,} \PY{n}{norm}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{plasma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{norm}\PY{o}{=}\PY{n}{colors}\PY{o}{.}\PY{n}{LogNorm}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{v1}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{v1}\PY{o}{.}\PY{n}{y}\PY{p}{)}

\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Velocity Field at a corner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{fig}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{cs}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Homework 5_files/Homework 5_14_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Here is the path of a particle started near one corner that is pushed
around the boundary of a box formed by the limits of the graph (from 0
to 10 on both axes).

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{22}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{corner} \PY{o}{=} \PY{n}{VortexManager}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{boundaries}\PY{o}{=}\PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bottom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}
\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{v1} \PY{o}{=} \PY{n}{corner}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{dt} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{)}
\PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{)}

\PY{c+c1}{\PYZsh{} anim = animate(corner, x, y, dt, figsize=(6,6), duration=1000)}
\PY{c+c1}{\PYZsh{} anim.save(\PYZsq{}./corner\PYZus{}boundary.gif\PYZsq{})}

\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
\PY{n}{points} \PY{o}{=} \PY{n}{corner}\PY{o}{.}\PY{n}{step\PYZus{}forward}\PY{p}{(}\PY{n}{dt}\PY{p}{,} \PY{l+m+mi}{750}\PY{p}{)}
\PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{o}{*}\PY{n}{points}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Corner Boundaries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Homework 5_files/Homework 5_17_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Leapfrogging Vortices}\label{leapfrogging-vortices}

    We observe that vortices constructed on the corners of a square with
opposite circulations on the top and bottom advect each other leftwards
in a rather intereresting pattern.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{leapfrog} \PY{o}{=} \PY{n}{VortexManager}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n}{b1} \PY{o}{=} \PY{n}{leapfrog}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{b2} \PY{o}{=} \PY{n}{leapfrog}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{t1} \PY{o}{=} \PY{n}{leapfrog}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{t2} \PY{o}{=} \PY{n}{leapfrog}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}

\PY{n}{dt} \PY{o}{=} \PY{l+m+mf}{0.1}
\PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}
\PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{60}\PY{p}{)}

\PY{c+c1}{\PYZsh{} anim = animate(leapfrog, y, x, dt, figsize=(10, 5), duration=200)}
\PY{c+c1}{\PYZsh{} anim.save(\PYZsq{}./leapfrogging.gif\PYZsq{})}

\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
\PY{n}{points} \PY{o}{=} \PY{n}{leapfrog}\PY{o}{.}\PY{n}{step\PYZus{}forward}\PY{p}{(}\PY{n}{dt}\PY{p}{,} \PY{l+m+mi}{260}\PY{p}{)}
\PY{k}{for} \PY{n}{point} \PY{o+ow}{in} \PY{n}{points}\PY{p}{:}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{o}{*}\PY{n}{point}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Leapfrogging Vortices}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Homework 5_files/Homework 5_20_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    If we perturb the location of one of the vortices even slightly, we see
the trajectories are quickly pushed off course, showing the system is
prone to chaotic behavior.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{leapfrog2} \PY{o}{=} \PY{n}{VortexManager}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{)}

\PY{c+c1}{\PYZsh{} This one is just a little off!}
\PY{n}{b1} \PY{o}{=} \PY{n}{leapfrog2}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.01}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}

\PY{n}{b2} \PY{o}{=} \PY{n}{leapfrog2}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{t1} \PY{o}{=} \PY{n}{leapfrog2}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{t2} \PY{o}{=} \PY{n}{leapfrog2}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}

\PY{n}{dt} \PY{o}{=} \PY{l+m+mf}{0.1}
\PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}
\PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{60}\PY{p}{)}

\PY{c+c1}{\PYZsh{} anim = animate(leapfrog, y, x, dt, figsize=(10, 5), duration=200)}
\PY{c+c1}{\PYZsh{} anim.save(\PYZsq{}./leapfrogging.gif\PYZsq{})}

\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
\PY{n}{points} \PY{o}{=} \PY{n}{leapfrog2}\PY{o}{.}\PY{n}{step\PYZus{}forward}\PY{p}{(}\PY{n}{dt}\PY{p}{,} \PY{l+m+mi}{260}\PY{p}{)}
\PY{k}{for} \PY{n}{point} \PY{o+ow}{in} \PY{n}{points}\PY{p}{:}
    \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{o}{*}\PY{n}{point}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Chaotic trajectories from small perturbations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Homework 5_files/Homework 5_22_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Appendix: Code}\label{appendix-code}

I may have gotten a little carried away here and I found it easier to
start a whole package. The key code is in \texttt{tangential\_vel} and
\texttt{velocity\_from\_vortex} for computing velocities.
\texttt{advect} is used to move the vortices around, and
\texttt{step\_forward} is a utility function I use to trace the path of
the vortices in the graphs above. Mirror vortices for boundaries are
calculated in \texttt{mirror\_vortices}. The second file,
\texttt{anim\_util.py} just has some helper methods for creating cool
animations, but none of those ended up in this main homework file,
although I may attach some of them to the submission because they look
cool. There are one or two other files but those are mostly just
boilerplate to make the package work.

Sorry there aren't more comments and some of the docstrings are missing.

\subsection{Vortex / VortexManager}\label{vortex-vortexmanager}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k+kn}{import} \PY{n}{Code}

\PY{n}{Code}\PY{p}{(}\PY{n}{filename}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./src/hw5/vortex.py}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}
 
            
\prompt{Out}{outcolor}{26}{}
    
    \begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{\PYZus{}\PYZus{}future\PYZus{}\PYZus{}} \PY{k+kn}{import} \PY{n}{annotations}

\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{from} \PY{n+nn}{numpy}\PY{n+nn}{.}\PY{n+nn}{typing} \PY{k+kn}{import} \PY{n}{ArrayLike}\PY{p}{,} \PY{n}{NDArray}

\PY{k+kn}{from} \PY{n+nn}{typing} \PY{k+kn}{import} \PY{n}{Dict}\PY{p}{,} \PY{n}{Set}

\PY{k}{def} \PY{n+nf}{tangential\PYZus{}vel}\PY{p}{(}\PY{n}{r}\PY{p}{,} \PY{n}{circulation}\PY{p}{,} \PY{n}{zero\PYZus{}cutoff}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}10}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Compute the tangential component of velocity away from a vortex}
\PY{l+s+sd}{    }
\PY{l+s+sd}{    Args:}
\PY{l+s+sd}{        r: The radius away from the vortex center}
\PY{l+s+sd}{        circulation: The circulation of the vortex}
\PY{l+s+sd}{        zero\PYZus{}cutoff: The tolerance under which to treat the radius as zero}
\PY{l+s+sd}{        }
\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        The tangential component of velocity at a distance `r` from a vortex}
\PY{l+s+sd}{        with circulation `circulation`.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{c+c1}{\PYZsh{} TODO: I\PYZsq{}m guessing this \PYZsq{}with\PYZsq{} paradigm isn\PYZsq{}t very performant in loops}
    \PY{k}{with} \PY{n}{np}\PY{o}{.}\PY{n}{errstate}\PY{p}{(}\PY{n}{divide}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{r} \PY{o}{\PYZgt{}} \PY{l+m+mf}{1e\PYZhy{}10}\PY{p}{,} \PY{n}{circulation} \PY{o}{/} \PY{p}{(}\PY{n}{r} \PY{o}{*} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{velocity\PYZus{}from\PYZus{}vortex}\PY{p}{(}\PY{n}{vortex\PYZus{}x}\PY{p}{,} \PY{n}{vortex\PYZus{}y}\PY{p}{,} \PY{n}{circulation}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Calculate the velocity at a point given the position and circulation of a}
\PY{l+s+sd}{    vortex.}

\PY{l+s+sd}{    Below: m is a scalar natural number, N is a (possibly) shape tuple, or a}
\PY{l+s+sd}{    scalar.}

\PY{l+s+sd}{    Args:}
\PY{l+s+sd}{        vortex\PYZus{}x: (m,) x coordinates of vortices}
\PY{l+s+sd}{        vortex\PYZus{}y: (m,) y coordinates of vortices}
\PY{l+s+sd}{        circulation: (m,) circulations}
\PY{l+s+sd}{        x: (N,) x points}
\PY{l+s+sd}{        y: (N,) y points}

\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        (2, N) matrix of velocities. In 2D, the first row is the x\PYZhy{}coordinate,}
\PY{l+s+sd}{        and the second row is the y\PYZhy{}coordinate. If N is a shape tuple, then the}
\PY{l+s+sd}{        first array contains the x\PYZhy{}coordinates and the second the y\PYZhy{}coordinates.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}

    \PY{c+c1}{\PYZsh{} Vectorize everything!}
    \PY{n}{vortex\PYZus{}x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{atleast\PYZus{}1d}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{vortex\PYZus{}x}\PY{p}{)}\PY{p}{)}
    \PY{n}{vortex\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{atleast\PYZus{}1d}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{vortex\PYZus{}y}\PY{p}{)}\PY{p}{)}
    \PY{n}{circulation} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{atleast\PYZus{}1d}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{circulation}\PY{p}{)}\PY{p}{)}
    \PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{atleast\PYZus{}1d}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{)}
    \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{atleast\PYZus{}1d}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} x \PYZhy{} vortex\PYZus{}x: (m, N)}
    \PY{n}{x\PYZus{}dist} \PY{o}{=} \PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{vortex\PYZus{}x}\PY{p}{[}\PY{p}{(}\PY{o}{.}\PY{o}{.}\PY{o}{.}\PY{p}{,}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{newaxis}\PY{p}{,}\PY{p}{)} \PY{o}{*} \PY{n}{x}\PY{o}{.}\PY{n}{ndim}\PY{p}{]}
    \PY{c+c1}{\PYZsh{} y \PYZhy{} vortex\PYZus{}y: (m, N)}
    \PY{n}{y\PYZus{}dist} \PY{o}{=} \PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{vortex\PYZus{}y}\PY{p}{[}\PY{p}{(}\PY{o}{.}\PY{o}{.}\PY{o}{.}\PY{p}{,}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{newaxis}\PY{p}{,}\PY{p}{)} \PY{o}{*} \PY{n}{y}\PY{o}{.}\PY{n}{ndim}\PY{p}{]}

    \PY{c+c1}{\PYZsh{} (m, N) \PYZhy{}\PYZgt{} (m, N)}
    \PY{n}{distance} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{x\PYZus{}dist}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{y\PYZus{}dist}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} dist: (m, N); circ: (m,) \PYZhy{}\PYZgt{} vel: (m, N)}
    \PY{n}{speed} \PY{o}{=} \PY{n}{tangential\PYZus{}vel}\PY{p}{(}\PY{n}{distance}\PY{p}{,} \PY{n}{circulation}\PY{p}{[}\PY{p}{(}\PY{o}{.}\PY{o}{.}\PY{o}{.}\PY{p}{,}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{newaxis}\PY{p}{,}\PY{p}{)} \PY{o}{*} \PY{n}{x}\PY{o}{.}\PY{n}{ndim}\PY{p}{]}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} (m, N) \PYZhy{}\PYZgt{} (m, N)}
    \PY{n}{angle} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arctan2}\PY{p}{(}\PY{n}{y\PYZus{}dist}\PY{p}{,} \PY{n}{x\PYZus{}dist}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} speed: (m, N); angle: (m, N) \PYZhy{}cos/sin\PYZhy{}\PYZgt{} (2, m, N) \PYZhy{}sum\PYZhy{}\PYZgt{} (2, N)}
    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{speed} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{angle}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{angle}\PY{p}{)}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}

\PY{k}{class} \PY{n+nc}{VortexManager}\PY{p}{:}
    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{default\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}deleted}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{boundaries}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{default\PYZus{}size} \PY{o}{=} \PY{n}{default\PYZus{}size}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{max\PYZus{}deleted} \PY{o}{=} \PY{n}{max\PYZus{}deleted}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{deleted}\PY{p}{:} \PY{n}{Set}\PY{p}{[}\PY{n+nb}{int}\PY{p}{]} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{p}{)}
        
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{index\PYZus{}mapping}\PY{p}{:} \PY{n}{Dict}\PY{p}{[}\PY{n+nb}{int}\PY{p}{,} \PY{n}{Vortex}\PY{p}{]} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} rows are coordinate axes, columns are coordinate pairs}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{default\PYZus{}size}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{circulations} \PY{o}{=} \PY{l+m+mi}{0} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{default\PYZus{}size}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{core\PYZus{}radii} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{default\PYZus{}size}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{end} \PY{o}{=} \PY{l+m+mi}{0}

        \PY{c+c1}{\PYZsh{} boundaries for mirror vortices}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{boundaries} \PY{o}{=} \PY{n}{boundaries}

    \PY{k}{def} \PY{n+nf}{add}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{x}\PY{p}{:} \PY{n+nb}{float}\PY{p}{,} \PY{n}{y}\PY{p}{:} \PY{n+nb}{float}\PY{p}{,} \PY{n}{circulation}\PY{p}{:} \PY{n+nb}{float}\PY{p}{,} \PY{n}{core\PYZus{}radius}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{name}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{Vortex}\PY{p}{:}
        \PY{k}{return} \PY{n}{Vortex}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{circulation}\PY{p}{,} \PY{n}{core\PYZus{}radius}\PY{p}{,} \PY{n}{name}\PY{p}{,} \PY{n}{manager}\PY{o}{=}\PY{n+nb+bp}{self}\PY{p}{)}
        
    \PY{k}{def} \PY{n+nf}{ensure\PYZus{}space}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{end} \PY{o}{==} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{:}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{zeros\PYZus{}like}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{circulations} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{circulations}\PY{p}{,} \PY{l+m+mi}{0} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{circulations}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{core\PYZus{}radii} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{core\PYZus{}radii}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{zeros\PYZus{}like}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{core\PYZus{}radii}\PY{p}{)}\PY{p}{)}\PY{p}{)}
            
    \PY{k}{def} \PY{n+nf}{register}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{vortex}\PY{p}{:} \PY{n}{Vortex}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n+nb}{int}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} Ensure there is enough room in the arrays}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{ensure\PYZus{}space}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Add to index mapping registry}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{index\PYZus{}mapping}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{end}\PY{p}{]} \PY{o}{=} \PY{n}{vortex}

        \PY{c+c1}{\PYZsh{} This is kinda goofy: add 1 and then subtract it}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{end} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{end} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}
    
    \PY{k}{def} \PY{n+nf}{deregister}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{vortex}\PY{p}{:} \PY{n}{Vortex} \PY{o}{|} \PY{n+nb}{int}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n+nb}{int}\PY{p}{:}
        \PY{k}{if} \PY{n+nb}{isinstance}\PY{p}{(}\PY{n}{vortex}\PY{p}{,} \PY{n+nb}{int}\PY{p}{)}\PY{p}{:}
            \PY{k}{pass}
        \PY{k}{else}\PY{p}{:}
            \PY{n}{vortex} \PY{o}{=} \PY{n}{vortex}\PY{o}{.}\PY{n}{\PYZus{}i}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{circulations}\PY{p}{[}\PY{n}{vortex}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nan}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{vortex}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nan}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{core\PYZus{}radii}\PY{p}{[}\PY{n}{vortex}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nan}
        
        \PY{k}{del} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{index\PYZus{}mapping}\PY{p}{[}\PY{n}{vortex}\PY{p}{]}\PY{o}{.}\PY{n}{\PYZus{}i}
        \PY{k}{del} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{index\PYZus{}mapping}\PY{p}{[}\PY{n}{vortex}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{deleted}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{vortex}\PY{p}{)}

        \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{deleted}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{max\PYZus{}deleted}\PY{p}{:}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{minimize\PYZus{}space}\PY{p}{(}\PY{p}{)}

    \PY{k}{def} \PY{n+nf}{minimize\PYZus{}space}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{k}{raise} \PY{n+ne}{NotImplementedError}\PY{p}{(}\PY{p}{)}
    
    \PY{n+nd}{@property}
    \PY{k}{def} \PY{n+nf}{non\PYZus{}nan\PYZus{}positions}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{NDArray}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{float64}\PY{p}{]}\PY{p}{:}
        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{o}{\PYZti{}}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{circulations}\PY{p}{)}\PY{p}{]}
    
    \PY{n+nd}{@property}
    \PY{k}{def} \PY{n+nf}{non\PYZus{}nan\PYZus{}circulations}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{NDArray}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{float64}\PY{p}{]}\PY{p}{:}
        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{circulations}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{circulations}\PY{p}{)}\PY{p}{]}
    
    \PY{n+nd}{@staticmethod}
    \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}reflection\PYZus{}matrix}\PY{p}{(}\PY{n}{angle}\PY{p}{:} \PY{n+nb}{float}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{NDArray}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{float64}\PY{p}{]}\PY{p}{:}
\PY{+w}{        }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}2D Reflection matrix for reflection across axis with the given}
\PY{l+s+sd}{        angle.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{angle}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{angle}\PY{p}{)}\PY{p}{]}\PY{p}{,}
                         \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{angle}\PY{p}{)}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{angle}\PY{p}{)}\PY{p}{]}\PY{p}{]}\PY{p}{)}
        
    \PY{n+nd}{@staticmethod}
    \PY{k}{def} \PY{n+nf}{reflect\PYZus{}across}\PY{p}{(}\PY{n}{pts}\PY{p}{,} \PY{n}{axis}\PY{p}{,} \PY{n}{angle}\PY{p}{)}\PY{p}{:}
\PY{+w}{        }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Reflect points across an axis.}

\PY{l+s+sd}{        Args:}
\PY{l+s+sd}{            pts: (2, n) The points to reflect.}
\PY{l+s+sd}{            axis: (2, 1) A point on the axis of reflection}
\PY{l+s+sd}{            angle: The angle of the axis of reflection}
\PY{l+s+sd}{            }
\PY{l+s+sd}{        Returns:}
\PY{l+s+sd}{            A (2, n) array of reflected points.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{n}{reflection} \PY{o}{=} \PY{n}{VortexManager}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}reflection\PYZus{}matrix}\PY{p}{(}\PY{n}{angle}\PY{p}{)}
        \PY{k}{return} \PY{n}{reflection} \PY{o}{@} \PY{p}{(}\PY{n}{pts} \PY{o}{\PYZhy{}} \PY{n}{axis}\PY{p}{)} \PY{o}{+} \PY{n}{axis}
    
    \PY{k}{def} \PY{n+nf}{mirror\PYZus{}vortices}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{recurse}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{VortexManager}\PY{p}{:}
        \PY{n}{l\PYZus{}mirror} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{reflect\PYZus{}across}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{vstack}\PY{p}{(}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{boundaries}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{r\PYZus{}mirror} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{reflect\PYZus{}across}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{vstack}\PY{p}{(}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{boundaries}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{b\PYZus{}mirror} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{reflect\PYZus{}across}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{vstack}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{boundaries}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bottom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{t\PYZus{}mirror} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{reflect\PYZus{}across}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{vstack}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{boundaries}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}

        \PY{n}{mirrors} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{(}\PY{n}{l\PYZus{}mirror}\PY{p}{,} \PY{n}{r\PYZus{}mirror}\PY{p}{,} \PY{n}{b\PYZus{}mirror}\PY{p}{,} \PY{n}{t\PYZus{}mirror}\PY{p}{)}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{circulations} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{repeat}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{circulations}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} I\PYZsq{}m kind of bastardizing my own code here. VortexManager isn\PYZsq{}t}
        \PY{c+c1}{\PYZsh{} designed to be used like this}
        \PY{n}{mirror\PYZus{}manager} \PY{o}{=} \PY{n}{VortexManager}\PY{p}{(}\PY{n}{boundaries}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{boundaries}\PY{p}{)}
        \PY{n}{mirror\PYZus{}manager}\PY{o}{.}\PY{n}{positions} \PY{o}{=} \PY{n}{mirrors}
        \PY{n}{mirror\PYZus{}manager}\PY{o}{.}\PY{n}{circulations} \PY{o}{=} \PY{n}{circulations}
        
        \PY{k}{if} \PY{n}{recurse} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
            \PY{n}{deeper} \PY{o}{=} \PY{n}{mirror\PYZus{}manager}\PY{o}{.}\PY{n}{mirror\PYZus{}vortices}\PY{p}{(}\PY{n}{recurse}\PY{o}{=}\PY{n}{recurse}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}

            \PY{n}{mirror\PYZus{}manager}\PY{o}{.}\PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{(}\PY{n}{mirrors}\PY{p}{,} \PY{n}{deeper}\PY{o}{.}\PY{n}{positions}\PY{p}{)}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
            \PY{n}{mirror\PYZus{}manager}\PY{o}{.}\PY{n}{circulations} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{(}\PY{n}{circulations}\PY{p}{,} \PY{n}{deeper}\PY{o}{.}\PY{n}{circulations}\PY{p}{)}\PY{p}{)}
        
        \PY{k}{return} \PY{n}{mirror\PYZus{}manager}
    
    \PY{k}{def} \PY{n+nf}{velocity\PYZus{}at}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{x}\PY{p}{:} \PY{n}{ArrayLike}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{float64}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{p}{:} \PY{n}{ArrayLike}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{float64}\PY{p}{]}\PY{p}{,} \PY{n}{mirror\PYZus{}vortices}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} xs, ys = np.meshgrid(self.positions[0, :], self.positions[1, :])}
        \PY{n}{vel} \PY{o}{=} \PY{n}{velocity\PYZus{}from\PYZus{}vortex}\PY{p}{(}\PY{o}{*}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{non\PYZus{}nan\PYZus{}positions}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{non\PYZus{}nan\PYZus{}circulations}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}
        
        \PY{k}{if} \PY{n}{mirror\PYZus{}vortices}\PY{p}{:}
            \PY{n}{vel} \PY{o}{+}\PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{mirror\PYZus{}vortices}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{velocity\PYZus{}at}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}

        \PY{k}{return} \PY{n}{vel}
    
    \PY{k}{def} \PY{n+nf}{advect}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{dt}\PY{p}{,} \PY{n}{mirror\PYZus{}vortices}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
\PY{+w}{        }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Move all the vortices based on their interactions with each other}
\PY{l+s+sd}{        }
\PY{l+s+sd}{        Args:}
\PY{l+s+sd}{            dt: Timestep}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions} \PY{o}{+}\PY{o}{=} \PY{n}{dt} \PY{o}{*} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{velocity\PYZus{}at}\PY{p}{(}\PY{o}{*}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}\PY{p}{)}
        
        \PY{k}{if} \PY{n}{mirror\PYZus{}vortices} \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{boundaries} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions} \PY{o}{+}\PY{o}{=} \PY{n}{dt} \PY{o}{*} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{mirror\PYZus{}vortices}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{velocity\PYZus{}at}\PY{p}{(}\PY{o}{*}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}\PY{p}{)}
            
    \PY{k}{def} \PY{n+nf}{step\PYZus{}forward}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{dt}\PY{p}{,} \PY{n}{steps}\PY{p}{)}\PY{p}{:}
\PY{+w}{        }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Advect the vortices by a number of steps.}

\PY{l+s+sd}{        Args:}
\PY{l+s+sd}{            dt: The timestep to use for advection}
\PY{l+s+sd}{            steps: The number of times to step forward}

\PY{l+s+sd}{        Returns:}
\PY{l+s+sd}{            An `(n, 2, steps+1)` array of points, where `n` is the number of}
\PY{l+s+sd}{            points in the vortex manager. The second axis is x and y}
\PY{l+s+sd}{            coordinates, and the last axis is the time. This works well for}
\PY{l+s+sd}{            plotting, because you can iterate through the first dimension,}
\PY{l+s+sd}{            calling `plot(*point)` on the remaining dimensions, which results in}
\PY{l+s+sd}{            line plots of the positions of all the particles.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{n}{history} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{steps}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{)} \PY{o}{+} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n}{history}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{p}{:}\PY{p}{]} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}

        \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{steps}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{advect}\PY{p}{(}\PY{n}{dt}\PY{p}{)}
            \PY{n}{history}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{p}{:}\PY{p}{]} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{positions}
            
        \PY{c+c1}{\PYZsh{} (times, 2, points) \PYZhy{}\PYZgt{} (points, 2, times)}
        \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{n}{history}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
    
    \PY{k}{def} \PY{n+nf}{plot\PYZus{}positions}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{ax}\PY{p}{,} \PY{o}{*}\PY{n}{args}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{o}{*}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{non\PYZus{}nan\PYZus{}positions}\PY{p}{,} \PY{o}{*}\PY{n}{args}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}

\PY{n}{DEFAULT\PYZus{}VORTEX\PYZus{}MANAGER} \PY{o}{=} \PY{n}{VortexManager}\PY{p}{(}\PY{p}{)}

\PY{k}{class} \PY{n+nc}{Vortex}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Simple model of a Point Vortex.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}

    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{x}\PY{p}{:} \PY{n+nb}{float}\PY{p}{,} \PY{n}{y}\PY{p}{:} \PY{n+nb}{float}\PY{p}{,} \PY{n}{circulation}\PY{p}{:} \PY{n+nb}{float}\PY{p}{,} \PY{n}{core\PYZus{}radius}\PY{p}{:} \PY{n+nb}{float}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{name}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{manager}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{n}{manager} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
            \PY{k}{global} \PY{n}{DEFAULT\PYZus{}VORTEX\PYZus{}MANAGER}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{manager} \PY{o}{=} \PY{n}{DEFAULT\PYZus{}VORTEX\PYZus{}MANAGER}
        \PY{k}{else}\PY{p}{:}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{manager} \PY{o}{=} \PY{n}{manager}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}i} \PY{o}{=} \PY{n}{manager}\PY{o}{.}\PY{n}{register}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}
        
        \PY{n}{manager}\PY{o}{.}\PY{n}{positions}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}i}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{]}
        \PY{n}{manager}\PY{o}{.}\PY{n}{circulations}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}i}\PY{p}{]} \PY{o}{=} \PY{n}{circulation}
        \PY{n}{manager}\PY{o}{.}\PY{n}{core\PYZus{}radii}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}i}\PY{p}{]} \PY{o}{=} \PY{n}{core\PYZus{}radius}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{n}{name}

    \PY{k}{def} \PY{n+nf}{tangential\PYZus{}vel}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{r}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{tangential\PYZus{}vel}\PY{p}{(}\PY{n}{r}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{circulation}\PY{p}{)}
    
    \PY{k}{def} \PY{n+nf}{velocity\PYZus{}from\PYZus{}vortex}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{velocity\PYZus{}from\PYZus{}vortex}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{circulation}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}
    
    \PY{n+nd}{@property}
    \PY{k}{def} \PY{n+nf}{vorticity}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} TODO calculate vorticity}
        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{circulation}
        
    \PY{n+nd}{@property}
    \PY{k}{def} \PY{n+nf}{x}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n+nb}{float}\PY{p}{:}
        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{manager}\PY{o}{.}\PY{n}{positions}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}i}\PY{p}{]}
    
    \PY{n+nd}{@x}\PY{o}{.}\PY{n}{setter}
    \PY{k}{def} \PY{n+nf}{x}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{val}\PY{p}{:} \PY{n+nb}{float}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{manager}\PY{o}{.}\PY{n}{positions}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}i}\PY{p}{]} \PY{o}{=} \PY{n}{val}
        
    \PY{n+nd}{@property}
    \PY{k}{def} \PY{n+nf}{y}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n+nb}{float}\PY{p}{:}
        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{manager}\PY{o}{.}\PY{n}{positions}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}i}\PY{p}{]}
    
    \PY{n+nd}{@y}\PY{o}{.}\PY{n}{setter}
    \PY{k}{def} \PY{n+nf}{y}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{val}\PY{p}{:} \PY{n+nb}{float}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n+nb}{float}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{manager}\PY{o}{.}\PY{n}{positions}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}i}\PY{p}{]} \PY{o}{=} \PY{n}{val}
        
    \PY{n+nd}{@property}
    \PY{k}{def} \PY{n+nf}{position}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{NDArray}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{float64}\PY{p}{]}\PY{p}{:}
        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{manager}\PY{o}{.}\PY{n}{positions}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}i}\PY{p}{]}
        
    \PY{n+nd}{@property}
    \PY{k}{def} \PY{n+nf}{circulation}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n+nb}{float}\PY{p}{:}
        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{manager}\PY{o}{.}\PY{n}{circulations}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}i}\PY{p}{]}
    
    \PY{n+nd}{@circulation}\PY{o}{.}\PY{n}{setter}
    \PY{k}{def} \PY{n+nf}{circulation}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{val}\PY{p}{:} \PY{n+nb}{float}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{manager}\PY{o}{.}\PY{n}{circulations}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}i}\PY{p}{]} \PY{o}{=} \PY{n}{val}
        
    \PY{n+nd}{@property}
    \PY{k}{def} \PY{n+nf}{core\PYZus{}radius}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n+nb}{float}\PY{p}{:}
        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{manager}\PY{o}{.}\PY{n}{core\PYZus{}radii}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}i}\PY{p}{]}
    
    \PY{n+nd}{@core\PYZus{}radius}\PY{o}{.}\PY{n}{setter}
    \PY{k}{def} \PY{n+nf}{core\PYZus{}radius}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{val}\PY{p}{:} \PY{n+nb}{float}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{manager}\PY{o}{.}\PY{n}{core\PYZus{}radii}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}i}\PY{p}{]} \PY{o}{=} \PY{n}{val}
\end{Verbatim}


    

    \subsection{anim\_util}\label{anim_util}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Code}\PY{p}{(}\PY{n}{filename}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./src/hw5/anim\PYZus{}util.py}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}
 
            
\prompt{Out}{outcolor}{27}{}
    
    \begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}

\PY{k+kn}{import} \PY{n+nn}{matplotlib}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{from} \PY{n+nn}{matplotlib} \PY{k+kn}{import} \PY{n}{animation}\PY{p}{,} \PY{n}{colors}

\PY{k+kn}{from} \PY{n+nn}{functools} \PY{k+kn}{import} \PY{n}{partial}

\PY{k+kn}{from} \PY{n+nn}{.} \PY{k+kn}{import} \PY{n}{VortexManager}

\PY{k}{def} \PY{n+nf}{update}\PY{p}{(}\PY{n}{frame}\PY{p}{,} \PY{n}{dt}\PY{p}{,} \PY{n}{xs}\PY{p}{,} \PY{n}{ys}\PY{p}{,} \PY{n}{field}\PY{p}{,} \PY{n}{positions}\PY{p}{,} \PY{n}{manager}\PY{p}{:} \PY{n}{VortexManager}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Update animation on each frame}
\PY{l+s+sd}{    }
\PY{l+s+sd}{    Args:}
\PY{l+s+sd}{        frame: index of the frame being rendered}
\PY{l+s+sd}{        ax: The axis on which the animation is plotted}
\PY{l+s+sd}{        contour: The velocity field magnitude contour}
\PY{l+s+sd}{        field: The velocity field directions quiver}
\PY{l+s+sd}{        positions: The scatter plot of vortex positions}
\PY{l+s+sd}{        m\PYZus{}positions: Positions of the mirror vortices}
\PY{l+s+sd}{        manager: VortexManager for the vortices}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}

    \PY{n}{manager}\PY{o}{.}\PY{n}{advect}\PY{p}{(}\PY{n}{dt}\PY{p}{,} \PY{n}{mirror\PYZus{}vortices}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

    \PY{n}{velocities} \PY{o}{=} \PY{n}{manager}\PY{o}{.}\PY{n}{velocity\PYZus{}at}\PY{p}{(}\PY{n}{xs}\PY{p}{,} \PY{n}{ys}\PY{p}{)}
    \PY{n}{norms} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{velocities}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
    \PY{n}{velocities} \PY{o}{/}\PY{o}{=} \PY{n}{norms}

    \PY{n}{field}\PY{o}{.}\PY{n}{set\PYZus{}UVC}\PY{p}{(}\PY{o}{*}\PY{n}{velocities}\PY{p}{,} \PY{n}{norms}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} positions = manager.plot\PYZus{}positions(ax, color=\PYZsq{}r\PYZsq{})}
    \PY{n}{positions}\PY{o}{.}\PY{n}{set\PYZus{}offsets}\PY{p}{(}\PY{n}{manager}\PY{o}{.}\PY{n}{positions}\PY{o}{.}\PY{n}{T}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} m\PYZus{}positions.set\PYZus{}offsets(manager.mirror\PYZus{}vortices().positions.T)}
    
    \PY{k}{return} \PY{n}{dt}\PY{p}{,} \PY{n}{xs}\PY{p}{,} \PY{n}{ys}\PY{p}{,} \PY{n}{field}\PY{p}{,} \PY{n}{positions}\PY{p}{,} \PY{n}{manager}

\PY{k}{def} \PY{n+nf}{animate}\PY{p}{(}\PY{n}{manager}\PY{p}{,} \PY{n}{grid\PYZus{}x}\PY{p}{,} \PY{n}{grid\PYZus{}y}\PY{p}{,} \PY{n}{dt}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{,} \PY{n}{save\PYZus{}loc}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{duration}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} matplotlib.use(\PYZsq{}tkagg\PYZsq{})}
    \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{n}{figsize}\PY{p}{)}

    \PY{n}{xs}\PY{p}{,} \PY{n}{ys} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{meshgrid}\PY{p}{(}\PY{n}{grid\PYZus{}x}\PY{p}{,} \PY{n}{grid\PYZus{}y}\PY{p}{)}

    \PY{n}{vel\PYZus{}field} \PY{o}{=} \PY{n}{manager}\PY{o}{.}\PY{n}{velocity\PYZus{}at}\PY{p}{(}\PY{n}{xs}\PY{p}{,} \PY{n}{ys}\PY{p}{)}
    \PY{n}{norms} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{vel\PYZus{}field}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}

    \PY{n}{vel\PYZus{}field} \PY{o}{/}\PY{o}{=} \PY{n}{norms}

    \PY{n}{field} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{quiver}\PY{p}{(}\PY{n}{xs}\PY{p}{,} \PY{n}{ys}\PY{p}{,} \PY{o}{*}\PY{n}{vel\PYZus{}field}\PY{p}{,} \PY{n}{norms}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{plasma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{norm}\PY{o}{=}\PY{n}{colors}\PY{o}{.}\PY{n}{LogNorm}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{angles}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{scale\PYZus{}units}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{units}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{minshaft}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{pivot}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tail}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{positions} \PY{o}{=} \PY{n}{manager}\PY{o}{.}\PY{n}{plot\PYZus{}positions}\PY{p}{(}\PY{n}{ax}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tab:red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Set some defaults for animation arguments}
    \PY{n}{kwargs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{repeat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{kwargs}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{repeat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{k+kc}{False}\PY{p}{)}
    \PY{n}{kwargs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cache\PYZus{}frame\PYZus{}data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{kwargs}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cache\PYZus{}frame\PYZus{}data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{k+kc}{False}\PY{p}{)}
    \PY{n}{kwargs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{interval}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{kwargs}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{interval}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{)}
    
    \PY{k}{if} \PY{n}{duration} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
        \PY{n}{kwargs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{frames}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{duration}\PY{p}{)}

    \PY{n}{anim} \PY{o}{=} \PY{n}{animation}\PY{o}{.}\PY{n}{FuncAnimation}\PY{p}{(}
        \PY{n}{fig}\PY{p}{,}
        \PY{n}{partial}\PY{p}{(}\PY{n}{update}\PY{p}{,} \PY{n}{dt}\PY{o}{=}\PY{n}{dt}\PY{p}{,} \PY{n}{xs}\PY{o}{=}\PY{n}{xs}\PY{p}{,} \PY{n}{ys}\PY{o}{=}\PY{n}{ys}\PY{p}{,} \PY{n}{field}\PY{o}{=}\PY{n}{field}\PY{p}{,} \PY{n}{positions}\PY{o}{=}\PY{n}{positions}\PY{p}{,}  \PY{n}{manager}\PY{o}{=}\PY{n}{manager}\PY{p}{)}\PY{p}{,}
        \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}
    \PY{p}{)}

    \PY{c+c1}{\PYZsh{} if save\PYZus{}loc is not None:}
    \PY{c+c1}{\PYZsh{}     anim.save(save\PYZus{}loc)}
    \PY{c+c1}{\PYZsh{} else:}
    \PY{c+c1}{\PYZsh{}     plt.show(block=True)}
    
    \PY{k}{return} \PY{n}{anim}
\end{Verbatim}


    

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
